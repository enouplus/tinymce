(function () 
{


    var buttons = (function () 
    {
        'use strict';

        tinymce.PluginManager.add("buttons", function (editor, url) 
        {

            function _onAction()
            {
                editor.windowManager.open
                ({
                    title: 'Add Bootstrap Button',
                    body: 
                    {
                        type: 'panel',
                        items: 
                        [
                            {
                                type: 'selectbox',
                                name: 'style',
                                label: 'Select Button Style',
                                items: 
                                [
                                    {text: 'Primary', value: 'btn-primary'},
                                    {text: 'Secondary', value: 'btn-secondary'},
                                    {text: 'Info', value: 'btn-info'},
                                    {text: 'Warning', value: 'btn-warning'},
                                    {text: 'Danger', value: 'btn-danger'},
                                    {text: 'Success', value: 'btn-success'},
                                    {text: 'Light', value: 'btn-light'},
                                    {text: 'Dark', value: 'btn-dark'}
                                ]
                                
                            },
                            {
                                type: 'selectbox',
                                name: 'size',
                                label: 'select button size',
                                items: 
                                [
                                    {text: 'Medium', value: ''},
                                    {text: 'Small', value: ' btn-sm'},
                                    {text: 'Large', value: ' btn-lg'}
                                ]
                                
                            },
                            {
                                type: 'input',
                                name: 'url',
                                label: 'URL'
                            }
                            ,
                            {
                                type: 'input',
                                name: 'text',
                                label: 'text to display'
                            },
                            {
                                type: 'checkbox', 
                                name: 'display', 
                                label: 'Full width button'
                            },
                            {
                                type: 'checkbox', 
                                name: 'target', 
                                label: 'open in new window'
                            }
                        ]
                    },
                    onSubmit: function (api) 
                    {
                        var classList=api.getData().style+api.getData().size;
                        if(api.getData().display==true)
                        {
                            classList+=" btn-block";
                        }
                        if(api.getData().target==true)
                        {
                            editor.insertContent('<a target="_blank" class="btn '+classList+'" href="'+api.getData().url+'">'+api.getData().text+'</a>');
                        }
                        else
                        {
                            editor.insertContent('<a class="btn '+classList+'" href="'+api.getData().url+'">'+api.getData().text+'</a>');
                        }
                        
                        api.close();
                    },
                    buttons: 
                    [
                        {
                            text: 'Close',
                            type: 'cancel',
                            onclick: 'close'
                        },
                        {
                            text: 'Insert',
                            type: 'submit',
                            primary: true,
                            enabled: false
                        }
                    ]
                });
            }

            editor.ui.registry.addButton('buttons', 
            {
                text: "Button",
                icon: "link",
                tooltip: "Bootstrap buttons",
                onAction: _onAction
            });

            
        });
    }
    ());


})();